name: Fetch commits
description: Fetch commits from a repository

permissions: read-all

jobs:
  - name: fetch-commits
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Fetch commit details
        run: |
          git fetch origin main --prune --unshallow --tags --force --progress --no-recurse-submodules --update-shallow --depth=1 --no-tags --quiet
          git log -n 10 --pretty=format:"%h %s" origin/main
          echo "Fetched commits from the main branch."
          echo "commit_details=$(git log -n 10 --pretty=format:'%h %s' origin/main)" >> $GITHUB_ENV

      - name: Output commit details
        run: |
          echo "The last 10 commits are:"
          echo "${{ env.commit_details }}"
          echo "Commit details have been stored in the environment variable."
          echo "You can use it in subsequent steps or jobs."
        env:
          commit_details: ${{ env.commit_details }}
